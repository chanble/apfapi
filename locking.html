<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=us-ascii"><title>Cloud9 API | C9 Developer</title><link href="/assets/csses/bootstrap.min.css" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/assets/csses/font-awesome.css"><link href="/assets/csses/docs.css" rel="stylesheet" type="text/css"><link rel="stylesheet" href="https://yandex.st/highlightjs/7.0/styles/default.min.css"><link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css"><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script><link type="text/css" rel="stylesheet" href="/css/developer.css"><script src="/js/bootstrap-transition.js"></script><link type='text/css' rel='stylesheet' href='/assets/csses/refguide_overrides.css' /><link type='text/css' rel='stylesheet' href='/assets/csses/api.css' /><script type='text/javascript' src='http://static.railstips.org/orderedlist/demos/quicksilverjs/javascripts/quicksilver.js'></script><script src='/assets/javascripts/bootstrap-tab.js'></script><script src='/assets/javascripts/jquery.livesearch.js'></script><script type='text/javascript' src='/assets/javascripts/clicker.js'></script><script type='text/javascript' src='/assets/javascripts/api.js'></script><script type='text/javascript' src='/assets/javascripts/jquery.cookie.js'></script></head><body data-spy="scroll" data-target=".tocContainer"><div id="topbar" class=""><a id="headerlink" href="/"><img src="/assets/img/c9devlogosmaller.png" /> <img src="/assets/img/c9developer_logo_text.png" width="90" alt="Developer" /></a><div class="toplink"><a href="/start">Start</a></div><div class="toplink"><a href="/guides/index.html">Dev Guides</a></div><div class="toplink active"><a href="/api/index.html">API</a></div><div class="toplink"><a href="/visual/index.html">Visual</a></div><div class="toplink"><a href="/sandbox">Sandbox</a></div><div class="toplink"><a href="/edit-in-cloud9-button">Edit in Cloud9</a></div></div><div id="main_container"><!DOCTYPE html><!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]> <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]--><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Cloud9 API Documentation - Locking</title><meta name="generator" content="panino-doc-build"><meta name="author" content="Garen J. Torikian"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/assets/csses/bootstrap.min.css"><link rel="stylesheet" href="/assets/csses/prettify.css"><link rel="stylesheet" href="/assets/csses/refguide_overrides.css"><link href="/assets/images/favicon.ico" rel="icon" type="image/x-icon"><link type="text/css" rel="stylesheet" href="//yandex.st/highlightjs/6.1/styles/vs.min.css"><script src="/assets/javascripts/jquery.js"></script><script src="/assets/javascripts/clicker.js"></script><script src="/assets/javascripts/jquery.collapse.js"></script><script src="/assets/javascripts/jquery.cookie.js"></script><script src="/assets/javascripts/bootstrap-dropdown.js"></script><script src="/assets/javascripts/bootstrap-tab.js"></script><script src="/assets/javascripts/jquery-scrollspy.js"></script></head><body><div class="container"><div id="sidebarContainer" class="span3"><div id="sidebar"><input id="live_search_toc"><p id="no_search_results"><span class="number_circle">!</span> No search results</p><h3>Containers<ul class="menu"><li class="menu-item"><a href = 'bar.html' classes='container'>apf.bar</a></li><li class="menu-item"><a href = 'frame.html' classes='container'>apf.frame</a></li><li class="menu-item"><a href = 'modalwindow.html' classes='container'>apf.modalwindow</a></li><li class="menu-item"><a href = 'page.html' classes='container'>apf.page</a></li><li class="menu-item"><a href = 'tab.html' classes='container'>apf.tab</a></li><li class="menu-item"><a href = 'table.html' classes='container'>apf.table</a></li><li class="menu-item"><a href = 'toolbar.html' classes='container'>apf.toolbar</a></li></ul></h3><h3>Form<ul class="menu"><li class="menu-item"><a href = 'button.html' classes='form'>apf.button</a></li><li class="menu-item"><a href = 'checkbox.html' classes='form'>apf.checkbox</a></li><li class="menu-item"><a href = 'dropdown.html' classes='form'>apf.dropdown</a></li><li class="menu-item"><a href = 'label.html' classes='form'>apf.label</a></li><li class="menu-item"><a href = 'progress.html' classes='form'>apf.progress</a></li><li class="menu-item"><a href = 'radiobutton.html' classes='form'>apf.radiobutton</a></li><li class="menu-item"><a href = 'spinner.html' classes='form'>apf.spinner</a></li><li class="menu-item"><a href = 'text.html' classes='form'>apf.text</a></li><li class="menu-item"><a href = 'textbox.html' classes='form'>apf.textbox</a></li></ul></h3><h3>Layout<ul class="menu"><li class="menu-item"><a href = 'hbox.html' classes='layout'>apf.hbox</a></li><li class="menu-item"><a href = 'hsplitbox.html' classes='layout'>apf.hsplitbox</a></li><li class="menu-item"><a href = 'skin.html' classes='layout'>apf.skin</a></li><li class="menu-item"><a href = 'vbox.html' classes='layout'>apf.vbox</a></li><li class="menu-item"><a href = 'vsplitbox.html' classes='layout'>apf.vsplitbox</a></li></ul></h3><h3>Selection<ul class="menu"><li class="menu-item"><a href = 'contextmenu.html' classes='selection'>apf.contextmenu</a></li><li class="menu-item"><a href = 'datagrid.html' classes='selection'>apf.datagrid</a></li><li class="menu-item"><a href = 'item.html' classes='selection'>apf.item</a></li><li class="menu-item"><a href = 'list.html' classes='selection'>apf.list</a></li><li class="menu-item"><a href = 'menu.html' classes='selection'>apf.menu</a></li><li class="menu-item"><a href = 'tree.html' classes='selection'>apf.tree</a></li></ul></h3><h3>Logic<ul class="menu"><li class="menu-item"><a href = 'actions.html' classes='logic'>apf.actions</a></li><li class="menu-item"><a href = 'actiontracker.html' classes='logic'>apf.actiontracker</a></li><li class="menu-item"><a href = 'appsettings.html' classes='logic'>apf.appsettings</a></li><li class="menu-item"><a href = 'model.html' classes='logic'>apf.model</a></li><li class="menu-item"><a href = 'script.html' classes='logic'>apf.script</a></li><li class="menu-item"><a href = 'state.html' classes='logic'>apf.state</a></li><li class="menu-item"><a href = 'stateGroup.html' classes='logic'>apf.stateGroup</a></li></ul></h3><h3>Media<ul class="menu"><li class="menu-item"><a href = 'img.html' classes='media'>apf.img</a></li><li class="menu-item"><a href = 'notifier.html' classes='media'>apf.notifier</a></li></ul></h3><h3>Parsing<ul class="menu"><li class="menu-item"><a href = 'url.html' classes='parser'>apf.url</a></li></ul></h3><h3>Base Classes<ul class="menu"><li class="menu-item"><a href = 'AmlElement.html' classes='baseclass'>apf.AmlElement</a></li><li class="menu-item"><a href = 'AmlNode.html' classes='baseclass'>apf.AmlNode</a></li><li class="menu-item"><a href = 'Anchoring.html' classes='baseclass'>apf.Anchoring</a></li><li class="menu-item"><a href = 'BaseButton.html' classes='baseclass'>apf.BaseButton</a></li><li class="menu-item"><a href = 'BaseList.html' classes='baseclass'>apf.BaseList</a></li><li class="menu-item"><a href = 'BaseSimple.html' classes='baseclass'>apf.BaseSimple</a></li><li class="menu-item"><a href = 'BaseStateButtons.html' classes='baseclass'>apf.BaseStateButtons</a></li><li class="menu-item"><a href = 'BaseTab.html' classes='baseclass'>apf.BaseTab</a></li><li class="menu-item"><a href = 'BaseTree.html' classes='baseclass'>apf.BaseTree</a></li><li class="menu-item"><a href = 'BindingRule.html' classes='baseclass'>apf.BindingRule</a></li><li class="menu-item"><a href = 'Cache.html' classes='baseclass'>apf.Cache</a></li><li class="menu-item"><a href = 'Class.html' classes='baseclass'>apf.Class</a></li><li class="menu-item"><a href = 'DataBinding.html' classes='baseclass'>apf.DataBinding</a></li><li class="menu-item"><a href = 'DelayedRender.html' classes='baseclass'>apf.DelayedRender</a></li><li class="menu-item"><a href = 'DragDrop.html' classes='baseclass'>apf.DragDrop</a></li><li class="menu-item"><a href = 'Focussable.html' classes='baseclass'>apf.Focussable</a></li><li class="menu-item"><a href = 'GuiElement.html' classes='baseclass'>apf.GuiElement</a></li><li class="menu-item"><a href = 'Interactive.html' classes='baseclass'>apf.Interactive</a></li><li class="menu-item"><a href = 'MultiCheck.html' classes='baseclass'>apf.MultiCheck</a></li><li class="menu-item"><a href = 'MultiSelect.html' classes='baseclass'>apf.MultiSelect</a></li><li class="menu-item"><a href = 'MultiselectBinding.html' classes='baseclass'>apf.MultiselectBinding</a></li><li class="menu-item"><a href = 'Presentation.html' classes='baseclass'>apf.Presentation</a></li><li class="menu-item"><a href = 'Rename.html' classes='baseclass'>apf.Rename</a></li><li class="menu-item"><a href = 'Validation.html' classes='baseclass'>apf.Validation</a></li></ul></h3><h3>Terms<ul class="menu"><li><a href="./actionrules.html">Action Rules</a></li><li><a href="./baseclass.html">  Base Classes</a></li><li><a href="./bindingrules.html">Binding Rules</a></li><li><a href="./caret.html">Caret</a></li><li><a href="./datainstruction.html">Data Instructions</a></li><li><a href="./datanode.html">Data Node</a></li><li><a href="./eachnode.html">Each Node</a></li><li><a href="./livemarkup.html">Live Markup</a></li><li><a href="./locking.html">Locking</a></li><li><a href="./propertybinding.html">Property Binding</a></li><li><a href="./smartbinding.html">Smart Binding</a></li></ul></h3></div></div><div id="mainContent" class="span9"><div id="documentation"><div class="title"><h1 class="pageTitle">Locking</h1></div><div><p><a href="http://en.wikipedia.org/wiki/Lock_(computer_science">A lock</a>)
is a mechanism for enforcing limits on access to a resource in a
multi-user environment. Locks are one way of enforcing concurrency
control policies. Ajax.org Platform (APF) has support for locking in
combination with <a href="./actionrules.md">action rules</a>. There are two
types of locks; pessimistic and optimistic locks. Descriptions below are
from <a href="http://en.wikipedia.org/wiki/Lock_(computer_science">wikipedia</a>).</p>
<h2 id='optimistic'><a class='heading_anchor' href='#optimistic'><i class='headerLinkIcon'></i></a>Optimistic</h2>
<p>This allows multiple concurrent users access to the database whilst the
system keeps a copy of the initial-read made by each user. When a user
wants to update a record, the application determines whether another user
has changed the record since it was last read. The application does this
by comparing the initial-read held in memory to the database record to
verify any changes made to the record. Any discrepancies between the
initial-read and the database record violates concurrency rules and hence
causes the system to disregard any update request. An error message is
generated and the user is asked to start the update process again.
It improves database performance by reducing the amount of locking
required, thereby reducing the load on the database server. It works
efficiently with tables that require limited updates since no users are
locked out. However, some updates may fail. The downside is constant
update failures due to high volumes of update requests from multiple
concurrent users - it can be frustrating for users.</p>
<p>For optimistic locking APF can run as if there would be no locking.
Changed data is sent to the server and is either successfully saved or
not. When the action isn&#39;t changed and the server returns an error code
the <code>apf.actiontracker</code> <strong>automatically
reverts the change</strong>.</p>
<h2 id='pessimistic'><a class='heading_anchor' href='#pessimistic'><i class='headerLinkIcon'></i></a>Pessimistic</h2>
<p>This is whereby a user who reads a record with the intention of updating
it, places an exclusive lock on the record to prevent other users from
manipulating it. This means no one else can manipulate that record until
the user releases the lock. The downside is that users can be locked out
for a long time thereby causing frustration.</p>
<p>For pessimistic locking add the locking attribute to the <a href="./actionrules.html">action rules</a>
that need it. The following example shows a lock request for a rename
action on a file browser tree.</p>
<pre><code class="language-xml"> <span class="tag">&lt;<span class="title">a:rename</span> <span class="attribute">set</span>=<span class="value">"..."</span> <span class="attribute">lock</span>=<span class="value">"{comm.lockFile([@path], unlock)}"</span> /></span></code></pre>
<p>The unlock variable is true when the lock needs to be released. This is
done when the action was cancelled after getting a lock. For instance
when the user presses escape while renaming.</p>
<h3 id='multiuser'><a class='heading_anchor' href='#multiuser'><i class='headerLinkIcon'></i></a>MultiUser</h3>
<p>In multi-user environments it can be handy
to be signalled of changes by others within the application. For more
information on this please look at <code>apf.remote</code>.</p>
<h3 id='remarks'><a class='heading_anchor' href='#remarks'><i class='headerLinkIcon'></i></a>Remarks</h3>
<p>During offline works pessimistic locks will always fail. If the application
does not use remote smart bindings the developer
should reload the part of the content for which the lock failed. See <code>databinding@lockfailed</code>.</p>
<div class="alert alert-success"><h4 class="alert-heading">Note: </h4>APF understands the status codes specified in <a href="http://tools.ietf.org/html/rfc4918#section-9.10.6">RFC4918</a> for the locking implementation</div>
</div></div><div id="disqus_thread"></div></div></div><div class="push"></div><script src="/assets/javascripts/ux.js"></script></body></html></div><div id="footer" class="span12 center"><p>&copy; 2012 Cloud9 IDE, Inc. All rights reserved.</p></div></body></html>